# é¡¹ç›®è¯´æ˜æ–‡æ¡£

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
4. [Next.js ä¸ React çš„æ ¸å¿ƒåŒºåˆ«](#nextjs-ä¸-react-çš„æ ¸å¿ƒåŒºåˆ«)
5. [Next.js åŸºäº React çš„å°è£…](#nextjs-åŸºäº-react-çš„å°è£…)
6. [é¡¹ç›®ç»“æ„è¯´æ˜](#é¡¹ç›®ç»“æ„è¯´æ˜)
7. [æ ¸å¿ƒåŠŸèƒ½å®ç°](#æ ¸å¿ƒåŠŸèƒ½å®ç°)
8. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

---

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Next.js 14** æ„å»ºçš„ä¸ªäººåšå®¢ç³»ç»Ÿï¼Œé‡‡ç”¨ **App Router** æ¶æ„ï¼Œæ”¯æŒ Markdown æ–‡ç« ç®¡ç†ã€åˆ†ç±»æµè§ˆã€å“åº”å¼è®¾è®¡ç­‰åŠŸèƒ½ã€‚

### ä¸»è¦ç‰¹æ€§

- ğŸ“ Markdown æ–‡ç« æ”¯æŒï¼ˆæ”¯æŒ Frontmatterï¼‰
- ğŸ—‚ï¸ ä¸¤çº§åˆ†ç±»ç³»ç»Ÿï¼ˆä¸€çº§åˆ†ç±»/äºŒçº§åˆ†ç±»ï¼‰
- ğŸ“± å“åº”å¼è®¾è®¡ï¼ˆæ¡Œé¢ç«¯/ç§»åŠ¨ç«¯è‡ªé€‚åº”ï¼‰
- ğŸŒ™ æ·±è‰²æ¨¡å¼æ”¯æŒ
- ğŸ“‘ æ–‡ç« ç›®å½•ï¼ˆTOCï¼‰è‡ªåŠ¨ç”Ÿæˆ
- ğŸ–¼ï¸ å›¾ç‰‡èµ„æºç®¡ç†
- âš¡ é™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼‰
- ğŸ” SEO å‹å¥½

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **Next.js 14.2.0** - React å…¨æ ˆæ¡†æ¶
- **React 18.3.0** - UI åº“
- **TypeScript 5.3.0** - ç±»å‹å®‰å…¨

### æ ·å¼æ–¹æ¡ˆ
- **Tailwind CSS 3.4.1** - å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- **@tailwindcss/typography** - æ–‡ç« æ’ç‰ˆæ ·å¼

### Markdown å¤„ç†
- **gray-matter** - Frontmatter è§£æ
- **remark** - Markdown å¤„ç†å¼•æ“
- **remark-html** - Markdown è½¬ HTML
- **remark-gfm** - GitHub Flavored Markdown æ”¯æŒ

### å·¥å…·åº“
- **date-fns 3.3.1** - æ—¥æœŸæ ¼å¼åŒ–

---

## é¡¹ç›®æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Next.js App Router             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Pages   â”‚  â”‚  Layout  â”‚  â”‚ API  â”‚ â”‚
â”‚  â”‚ (è·¯ç”±)   â”‚  â”‚ (å¸ƒå±€)   â”‚  â”‚(è·¯ç”±)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Componentsâ”‚  â”‚   Lib    â”‚  â”‚Blogs â”‚ â”‚
â”‚  â”‚ (ç»„ä»¶)   â”‚  â”‚ (å·¥å…·)   â”‚  â”‚(å†…å®¹)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„ç‰¹ç‚¹

1. **æ–‡ä»¶ç³»ç»Ÿè·¯ç”±**ï¼šåŸºäº `app` ç›®å½•çš„æ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±
2. **æœåŠ¡ç«¯ä¼˜å…ˆ**ï¼šé»˜è®¤æœåŠ¡ç«¯ç»„ä»¶ï¼ŒæŒ‰éœ€ä½¿ç”¨å®¢æˆ·ç«¯ç»„ä»¶
3. **API Routes**ï¼šå†…ç½® API è·¯ç”±å¤„ç†åŠ¨æ€è¯·æ±‚
4. **é™æ€ç”Ÿæˆ**ï¼šæ„å»ºæ—¶é¢„æ¸²æŸ“é¡µé¢ï¼Œæå‡æ€§èƒ½

---

## Next.js ä¸ React çš„æ ¸å¿ƒåŒºåˆ«

### 1. è·¯ç”±ç³»ç»Ÿ

#### Reactï¼ˆä¼ ç»Ÿ SPAï¼‰
```tsx
// éœ€è¦å®‰è£… react-router-dom
import { BrowserRouter, Routes, Route } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/posts/:id" element={<Post />} />
      </Routes>
    </BrowserRouter>
  );
}
```

#### Next.jsï¼ˆæ–‡ä»¶ç³»ç»Ÿè·¯ç”±ï¼‰
```tsx
// app/page.tsx - è‡ªåŠ¨æˆä¸º "/" è·¯ç”±
export default function Home() {
  return <div>é¦–é¡µ</div>;
}

// app/posts/[slug]/page.tsx - è‡ªåŠ¨æˆä¸º "/posts/:slug" è·¯ç”±
export default function Post({ params }: { params: { slug: string } }) {
  return <div>æ–‡ç« : {params.slug}</div>;
}
```

**åŒºåˆ«**ï¼š
- Next.js åŸºäºæ–‡ä»¶ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
- æ”¯æŒåŠ¨æ€è·¯ç”±ã€åµŒå¥—è·¯ç”±ã€è·¯ç”±ç»„ç­‰é«˜çº§ç‰¹æ€§
- è·¯ç”±ä¸æ–‡ä»¶ç»“æ„ä¸€ä¸€å¯¹åº”ï¼Œæ›´ç›´è§‚

### 2. ç»„ä»¶æ¸²æŸ“æ–¹å¼

#### Reactï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰
```tsx
// æ‰€æœ‰ç»„ä»¶éƒ½åœ¨å®¢æˆ·ç«¯æ¸²æŸ“
function PostList() {
  const [posts, setPosts] = useState([]);
  
  useEffect(() => {
    fetch('/api/posts')
      .then(res => res.json())
      .then(setPosts);
  }, []);
  
  return <div>{/* æ¸²æŸ“æ–‡ç« åˆ—è¡¨ */}</div>;
}
```

#### Next.jsï¼ˆæœåŠ¡ç«¯ç»„ä»¶ + å®¢æˆ·ç«¯ç»„ä»¶ï¼‰
```tsx
// app/posts/page.tsx - æœåŠ¡ç«¯ç»„ä»¶ï¼ˆé»˜è®¤ï¼‰
// å¯ä»¥ç›´æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ç­‰
import { getAllPosts } from '@/lib/posts';

export default async function PostsPage() {
  // åœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œæ„å»ºæ—¶æˆ–è¯·æ±‚æ—¶è¿è¡Œ
  const posts = getAllPosts();
  
  return <PostList posts={posts} />;
}

// components/PostList.tsx - å®¢æˆ·ç«¯ç»„ä»¶ï¼ˆéœ€è¦äº¤äº’æ—¶ï¼‰
"use client";

export function PostList({ posts }) {
  const [filter, setFilter] = useState('');
  // å®¢æˆ·ç«¯äº¤äº’é€»è¾‘
  return <div>{/* æ¸²æŸ“æ–‡ç« åˆ—è¡¨ */}</div>;
}
```

**åŒºåˆ«**ï¼š
- Next.js é»˜è®¤æœåŠ¡ç«¯ç»„ä»¶ï¼Œå‡å°‘å®¢æˆ·ç«¯ JavaScript ä½“ç§¯
- æœåŠ¡ç«¯ç»„ä»¶å¯ä»¥ç›´æ¥è®¿é—®åç«¯èµ„æºï¼ˆæ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ç­‰ï¼‰
- å®¢æˆ·ç«¯ç»„ä»¶éœ€è¦ `"use client"` æŒ‡ä»¤ï¼Œç”¨äºäº¤äº’åŠŸèƒ½

### 3. æ•°æ®è·å–

#### Reactï¼ˆå®¢æˆ·ç«¯è·å–ï¼‰
```tsx
function Post({ id }) {
  const [post, setPost] = useState(null);
  
  useEffect(() => {
    fetch(`/api/posts/${id}`)
      .then(res => res.json())
      .then(setPost);
  }, [id]);
  
  if (!post) return <div>åŠ è½½ä¸­...</div>;
  return <article>{post.content}</article>;
}
```

#### Next.jsï¼ˆæœåŠ¡ç«¯è·å–ï¼‰
```tsx
// æ–¹å¼1ï¼šæœåŠ¡ç«¯ç»„ä»¶ç›´æ¥è·å–
export default async function Post({ params }: { params: { slug: string } }) {
  const post = await getPostBySlug(params.slug);
  return <article dangerouslySetInnerHTML={{ __html: post.htmlContent }} />;
}

// æ–¹å¼2ï¼šé™æ€ç”Ÿæˆï¼ˆæ„å»ºæ—¶ï¼‰
export async function generateStaticParams() {
  const posts = getAllPosts();
  return posts.map(post => ({ slug: post.slug }));
}
```

**åŒºåˆ«**ï¼š
- Next.js æ”¯æŒæœåŠ¡ç«¯æ•°æ®è·å–ï¼Œæ— éœ€é¢å¤–çš„ API è°ƒç”¨
- æ”¯æŒé™æ€ç”Ÿæˆï¼ˆSSGï¼‰ï¼Œæ„å»ºæ—¶é¢„æ¸²æŸ“æ‰€æœ‰é¡µé¢
- æ”¯æŒå¢é‡é™æ€å†ç”Ÿï¼ˆISRï¼‰ï¼ŒæŒ‰éœ€æ›´æ–°é™æ€é¡µé¢

### 4. é¡µé¢å…ƒæ•°æ®

#### Reactï¼ˆéœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼‰
```tsx
import { Helmet } from 'react-helmet';

function Post({ post }) {
  return (
    <>
      <Helmet>
        <title>{post.title}</title>
        <meta name="description" content={post.excerpt} />
      </Helmet>
      <article>{post.content}</article>
    </>
  );
}
```

#### Next.jsï¼ˆå†…ç½® Metadata APIï¼‰
```tsx
import type { Metadata } from 'next';

export const metadata: Metadata = {
  title: 'æ–‡ç« æ ‡é¢˜',
  description: 'æ–‡ç« æè¿°',
};

export default function Post() {
  return <article>å†…å®¹</article>;
}

// æˆ–åŠ¨æ€ç”Ÿæˆ
export async function generateMetadata({ params }): Promise<Metadata> {
  const post = await getPostBySlug(params.slug);
  return {
    title: post.title,
    description: post.excerpt,
  };
}
```

**åŒºåˆ«**ï¼š
- Next.js å†…ç½® Metadata APIï¼Œè‡ªåŠ¨å¤„ç† SEO
- æ”¯æŒé™æ€å’ŒåŠ¨æ€å…ƒæ•°æ®ç”Ÿæˆ
- è‡ªåŠ¨ä¼˜åŒ– HTML head æ ‡ç­¾

### 5. å›¾ç‰‡å¤„ç†

#### Reactï¼ˆéœ€è¦æ‰‹åŠ¨ä¼˜åŒ–ï¼‰
```tsx
<img src="/images/photo.jpg" alt="æè¿°" />
// éœ€è¦æ‰‹åŠ¨å®ç°æ‡’åŠ è½½ã€å“åº”å¼å›¾ç‰‡ç­‰
```

#### Next.jsï¼ˆå†…ç½® Image ç»„ä»¶ï¼‰
```tsx
import Image from 'next/image';

<Image
  src="/images/photo.jpg"
  alt="æè¿°"
  width={800}
  height={600}
  // è‡ªåŠ¨ä¼˜åŒ–ï¼šæ‡’åŠ è½½ã€WebP è½¬æ¢ã€å“åº”å¼ç­‰
/>
```

**åŒºåˆ«**ï¼š
- Next.js Image ç»„ä»¶è‡ªåŠ¨ä¼˜åŒ–å›¾ç‰‡
- æ”¯æŒæ‡’åŠ è½½ã€å“åº”å¼å›¾ç‰‡ã€WebP æ ¼å¼è½¬æ¢
- æå‡é¡µé¢åŠ è½½æ€§èƒ½

---

## Next.js åŸºäº React çš„å°è£…

Next.js åœ¨ React åŸºç¡€ä¸Šæä¾›äº†ä¸°å¯Œçš„å°è£…å’Œå¢å¼ºåŠŸèƒ½ï¼š

### 1. è·¯ç”±å°è£…

#### Link ç»„ä»¶
```tsx
// React éœ€è¦æ‰‹åŠ¨å¤„ç†è·¯ç”±è·³è½¬
<a href="/posts/123" onClick={(e) => {
  e.preventDefault();
  navigate('/posts/123');
}}>æŸ¥çœ‹æ–‡ç« </a>

// Next.js Link ç»„ä»¶
import Link from 'next/link';

<Link href="/posts/123">æŸ¥çœ‹æ–‡ç« </Link>
// è‡ªåŠ¨å¤„ç†ï¼šé¢„å–ã€å®¢æˆ·ç«¯å¯¼èˆªã€æ»šåŠ¨ä½ç½®ç­‰
```

**å°è£…ä¼˜åŠ¿**ï¼š
- è‡ªåŠ¨é¢„å–é“¾æ¥é¡µé¢ï¼ˆhover æ—¶ï¼‰
- å®¢æˆ·ç«¯å¯¼èˆªï¼ˆæ— éœ€æ•´é¡µåˆ·æ–°ï¼‰
- ä¿æŒæ»šåŠ¨ä½ç½®
- æ”¯æŒåŠ¨æ€è·¯ç”±

### 2. å¯¼èˆª Hook

```tsx
// Next.js æä¾›çš„å¯¼èˆª Hook
"use client";
import { useRouter, usePathname, useSearchParams } from 'next/navigation';

function Navigation() {
  const router = useRouter();
  const pathname = usePathname();
  const searchParams = useSearchParams();
  
  // ç¼–ç¨‹å¼å¯¼èˆª
  router.push('/posts/123');
  router.replace('/posts/123');
  router.back();
  
  // è·å–å½“å‰è·¯å¾„å’ŒæŸ¥è¯¢å‚æ•°
  console.log(pathname); // "/posts/123"
  console.log(searchParams.get('page')); // "1"
}
```

### 3. æœåŠ¡ç«¯ç»„ä»¶å¢å¼º

```tsx
// Next.js æœåŠ¡ç«¯ç»„ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨ async/await
export default async function PostsPage() {
  // åœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œå¯ä»¥è®¿é—®ï¼š
  // - æ–‡ä»¶ç³»ç»Ÿ
  // - æ•°æ®åº“
  // - APIï¼ˆå†…éƒ¨æˆ–å¤–éƒ¨ï¼‰
  // - ç¯å¢ƒå˜é‡
  
  const posts = await fetchPostsFromDatabase();
  
  return <PostList posts={posts} />;
}
```

### 4. æ•°æ®è·å–å°è£…

```tsx
// Next.js æä¾›å¤šç§æ•°æ®è·å–ç­–ç•¥

// 1. é™æ€ç”Ÿæˆï¼ˆæ„å»ºæ—¶ï¼‰
export async function generateStaticParams() {
  return [{ slug: 'post-1' }, { slug: 'post-2' }];
}

// 2. æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆæ¯æ¬¡è¯·æ±‚ï¼‰
export const dynamic = 'force-dynamic';

// 3. å¢é‡é™æ€å†ç”Ÿï¼ˆæŒ‰éœ€æ›´æ–°ï¼‰
export const revalidate = 3600; // æ¯ 3600 ç§’é‡æ–°ç”Ÿæˆ

// 4. æµå¼æ¸²æŸ“ï¼ˆé€æ­¥å‘é€ï¼‰
export default async function Page() {
  const posts = await fetchPosts();
  return (
    <Suspense fallback={<Loading />}>
      <PostList posts={posts} />
    </Suspense>
  );
}
```

### 5. API Routes å°è£…

```tsx
// app/api/posts/route.ts
import { NextRequest, NextResponse } from 'next/server';

// GET è¯·æ±‚
export async function GET(request: NextRequest) {
  const posts = getAllPosts();
  return NextResponse.json(posts);
}

// POST è¯·æ±‚
export async function POST(request: NextRequest) {
  const body = await request.json();
  // å¤„ç†æ•°æ®
  return NextResponse.json({ success: true });
}
```

**å°è£…ä¼˜åŠ¿**ï¼š
- æ— éœ€å•ç‹¬çš„åç«¯æœåŠ¡å™¨
- è‡ªåŠ¨å¤„ç† CORSã€è¯·æ±‚è§£æç­‰
- æ”¯æŒä¸­é—´ä»¶ã€è·¯ç”±å¤„ç†ç­‰

---

## é¡¹ç›®ç»“æ„è¯´æ˜

```
blog/
â”œâ”€â”€ app/                    # Next.js App Router ç›®å½•
â”‚   â”œâ”€â”€ layout.tsx          # æ ¹å¸ƒå±€ï¼ˆå…¨å±€ HTML ç»“æ„ï¼‰
â”‚   â”œâ”€â”€ page.tsx            # é¦–é¡µï¼ˆ/ è·¯ç”±ï¼‰
â”‚   â”œâ”€â”€ globals.css          # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ posts/               # æ–‡ç« è·¯ç”±
â”‚   â”‚   â””â”€â”€ [...slug]/       # åŠ¨æ€è·¯ç”±ï¼ˆæ•è·æ‰€æœ‰è·¯å¾„ï¼‰
â”‚   â”‚       â””â”€â”€ page.tsx     # æ–‡ç« è¯¦æƒ…é¡µ
â”‚   â””â”€â”€ api/                 # API è·¯ç”±
â”‚       â”œâ”€â”€ image/           # å›¾ç‰‡æœåŠ¡ API
â”‚       â”‚   â””â”€â”€ [...path]/
â”‚       â”‚       â””â”€â”€ route.ts
â”‚       â””â”€â”€ post/            # æ–‡ç«  API
â”‚           â””â”€â”€ [...slug]/
â”‚               â””â”€â”€ route.ts
â”‚
â”œâ”€â”€ blogs/                   # Markdown æ–‡ç« å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ å‰ç«¯/
â”‚   â”‚   â”œâ”€â”€ æ–‡ç« /
â”‚   â”‚   â”‚   â””â”€â”€ *.md
â”‚   â”‚   â””â”€â”€ æ—¥å¸¸è¿­ä»£/
â”‚   â”‚       â””â”€â”€ *.md
â”‚   â”œâ”€â”€ åç«¯/
â”‚   â””â”€â”€ ç®—æ³•/
â”‚
â”œâ”€â”€ components/              # React ç»„ä»¶
â”‚   â”œâ”€â”€ BlogLayout.tsx       # æ¡Œé¢ç«¯åšå®¢å¸ƒå±€
â”‚   â”œâ”€â”€ MobileBlogLayout.tsx # ç§»åŠ¨ç«¯åšå®¢å¸ƒå±€
â”‚   â””â”€â”€ ResponsiveBlogLayout.tsx # å“åº”å¼å¸ƒå±€åŒ…è£…å™¨
â”‚
â”œâ”€â”€ lib/                     # å·¥å…·å‡½æ•°åº“
â”‚   â”œâ”€â”€ posts.ts            # æ–‡ç« å¤„ç†é€»è¾‘
â”‚   â””â”€â”€ device.ts          # è®¾å¤‡æ£€æµ‹å·¥å…·
â”‚
â”œâ”€â”€ docs/                    # é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ é¡¹ç›®è¯´æ˜.md         # æœ¬æ–‡æ¡£
â”‚
â”œâ”€â”€ next.config.js          # Next.js é…ç½®
â”œâ”€â”€ tailwind.config.js      # Tailwind CSS é…ç½®
â”œâ”€â”€ tsconfig.json           # TypeScript é…ç½®
â””â”€â”€ package.json            # é¡¹ç›®ä¾èµ–
```

### å…³é”®æ–‡ä»¶è¯´æ˜

#### 1. `app/layout.tsx` - æ ¹å¸ƒå±€
```tsx
// å®šä¹‰å…¨å±€ HTML ç»“æ„ã€å…ƒæ•°æ®ã€å…¨å±€æ ·å¼
export default function RootLayout({ children }) {
  return (
    <html lang="zh-CN">
      <body>{children}</body>
    </html>
  );
}
```

#### 2. `app/page.tsx` - é¦–é¡µ
```tsx
// æœåŠ¡ç«¯ç»„ä»¶ï¼Œè·å–åˆ†ç±»ä¿¡æ¯å¹¶ä¼ é€’ç»™å®¢æˆ·ç«¯ç»„ä»¶
export default function Home() {
  const categoryInfo = getAllCategoryInfo();
  return <ResponsiveBlogLayout initialCategoryInfo={categoryInfo} />;
}
```

#### 3. `lib/posts.ts` - æ–‡ç« å¤„ç†æ ¸å¿ƒ
- æ‰«æ `blogs` ç›®å½•ä¸‹çš„ Markdown æ–‡ä»¶
- è§£æ Frontmatter å’Œå†…å®¹
- æå–æ–‡ç« ç›®å½•ï¼ˆTOCï¼‰
- å¤„ç†å›¾ç‰‡è·¯å¾„
- å°† Markdown è½¬æ¢ä¸º HTML

#### 4. `components/BlogLayout.tsx` - æ¡Œé¢ç«¯å¸ƒå±€
- å·¦ä¾§ï¼šåˆ†ç±»å¯¼èˆªæ ‘
- ä¸­é—´ï¼šæ–‡ç« ç›®å½•ï¼ˆå¯é€‰ï¼‰
- å³ä¾§ï¼šæ–‡ç« å†…å®¹æˆ–åˆ—è¡¨
- ä½¿ç”¨ URL å‚æ•°ç®¡ç†çŠ¶æ€

---

## æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. æ–‡ç« ç®¡ç†ç³»ç»Ÿ

#### æ–‡ç« å­˜å‚¨ç»“æ„
```
blogs/
  â””â”€â”€ {ä¸€çº§åˆ†ç±»}/
      â””â”€â”€ {äºŒçº§åˆ†ç±»}/
          â””â”€â”€ {æ–‡ä»¶å}.md
```

#### æ–‡ç« å¤„ç†æµç¨‹
```tsx
// lib/posts.ts

// 1. æ‰«æç›®å½•è·å–æ‰€æœ‰æ–‡ç« 
export function getAllPosts(): Post[] {
  // éå† blogs ç›®å½•
  // è§£æ Markdown æ–‡ä»¶
  // æå– Frontmatter
  // å¤„ç†å›¾ç‰‡è·¯å¾„
  // æå–ç›®å½•ï¼ˆTOCï¼‰
  // æŒ‰æ—¥æœŸæ’åº
}

// 2. æ ¹æ® slug è·å–å•ç¯‡æ–‡ç« 
export async function getPostBySlug(slug: string): Promise<Post | null> {
  // è§£æ slug è·¯å¾„
  // è¯»å– Markdown æ–‡ä»¶
  // è½¬æ¢ä¸º HTML
  // ä¸ºæ ‡é¢˜æ·»åŠ  IDï¼ˆç”¨äºç›®å½•è·³è½¬ï¼‰
}
```

### 2. å“åº”å¼å¸ƒå±€ç³»ç»Ÿ

#### è®¾å¤‡æ£€æµ‹
```tsx
// lib/device.ts
export function isMobileDevice(): boolean {
  // åŸºäº UA å’Œå±å¹•å®½åº¦åˆ¤æ–­
  return isMobileUserAgent() || isMobileScreenWidth();
}
```

#### å¸ƒå±€åˆ‡æ¢
```tsx
// components/ResponsiveBlogLayout.tsx
export function ResponsiveBlogLayout({ initialCategoryInfo }) {
  const [isMobile, setIsMobile] = useState(false);
  
  useEffect(() => {
    // å®¢æˆ·ç«¯æ¸²æŸ“åæ£€æµ‹è®¾å¤‡ç±»å‹
    setIsMobile(isMobileDevice());
  }, []);
  
  // æ ¹æ®è®¾å¤‡ç±»å‹é€‰æ‹©å¸ƒå±€
  return isMobile ? (
    <MobileBlogLayout />
  ) : (
    <BlogLayout />
  );
}
```

### 3. å›¾ç‰‡èµ„æºç®¡ç†

#### å›¾ç‰‡ API è·¯ç”±
```tsx
// app/api/image/[...path]/route.ts
export async function GET(request, { params }) {
  // è§£æå›¾ç‰‡è·¯å¾„
  // å®‰å…¨æ£€æŸ¥ï¼ˆé˜²æ­¢è·¯å¾„éå†ï¼‰
  // è¯»å–å›¾ç‰‡æ–‡ä»¶
  // è®¾ç½®æ­£ç¡®çš„ Content-Type
  // è¿”å›å›¾ç‰‡æ•°æ®
}
```

#### Markdown å›¾ç‰‡è·¯å¾„å¤„ç†
```tsx
// lib/posts.ts
// å°†ç›¸å¯¹è·¯å¾„è½¬æ¢ä¸º API è·¯ç”±
processedContent = processedContent.replace(
  /!\[([^\]]*)\]\(([^)]+)\)/g,
  (match, alt, imgPath) => {
    if (!imgPath.startsWith('http') && !imgPath.startsWith('/')) {
      return `![${alt}](/api/image/${category}/${subCategory}/${imgPath})`;
    }
    return match;
  }
);
```

### 4. æ–‡ç« ç›®å½•ï¼ˆTOCï¼‰ç”Ÿæˆ

```tsx
// lib/posts.ts
function extractTOC(content: string): TOCItem[] {
  // 1. è§£æ Markdown æ ‡é¢˜ï¼ˆ# ## ###ï¼‰
  // 2. ç”Ÿæˆæ ‡é¢˜ IDï¼ˆç”¨äºé”šç‚¹ï¼‰
  // 3. æ„å»ºå±‚çº§ç»“æ„
  // 4. è¿”å›æ ‘å½¢ç»“æ„
}

// åœ¨ HTML è½¬æ¢åï¼Œä¸ºæ ‡é¢˜æ·»åŠ  ID
htmlContent = htmlContent.replace(
  /<h([1-6])>(.*?)<\/h[1-6]>/g,
  (match, level, content) => {
    const id = generateId(content);
    return `<h${level} id="${id}">${content}</h${level}>`;
  }
);
```

### 5. é™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼‰

```tsx
// app/posts/[...slug]/page.tsx
export async function generateStaticParams() {
  // æ„å»ºæ—¶è·å–æ‰€æœ‰æ–‡ç« 
  const posts = getAllPosts();
  // ä¸ºæ¯ç¯‡æ–‡ç« ç”Ÿæˆé™æ€è·¯å¾„
  return posts.map((post) => ({
    slug: post.slug.split('/'),
  }));
}

// é¡µé¢ç»„ä»¶åœ¨æ„å»ºæ—¶é¢„æ¸²æŸ“
export default async function PostPage({ params }) {
  const post = await getPostBySlug(slug);
  return <article>{/* æ–‡ç« å†…å®¹ */}</article>;
}
```

---

## å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- Node.js 18+ 
- npm æˆ– yarn

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¼€å‘æ¨¡å¼

```bash
npm run dev
```

è®¿é—® http://localhost:3000

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm start
```

### æ·»åŠ æ–°æ–‡ç« 

1. åœ¨ `blogs/{åˆ†ç±»}/{å­åˆ†ç±»}/` ç›®å½•ä¸‹åˆ›å»º `.md` æ–‡ä»¶
2. æ–‡ä»¶åå¯ä»¥ä½œä¸ºæ—¥æœŸï¼ˆå¦‚ `24.12.31.md`ï¼‰æˆ–è‡ªå®šä¹‰åç§°
3. æ”¯æŒ Frontmatterï¼š

```markdown
---
title: æ–‡ç« æ ‡é¢˜
date: 24-12-31
---

# æ–‡ç« æ ‡é¢˜

æ–‡ç« å†…å®¹...
```

### é¡¹ç›®é…ç½®

#### Next.js é…ç½® (`next.config.js`)
```js
const nextConfig = {
  images: {
    unoptimized: true, // ç¦ç”¨å›¾ç‰‡ä¼˜åŒ–ï¼ˆå¦‚éœ€è¦ï¼‰
  },
}
```

#### TypeScript è·¯å¾„åˆ«å (`tsconfig.json`)
```json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./*"]  // ä½¿ç”¨ @/ å¼•ç”¨é¡¹ç›®æ ¹ç›®å½•
    }
  }
}
```

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡ç«¯ç»„ä»¶ vs å®¢æˆ·ç«¯ç»„ä»¶

**ä½•æ—¶ä½¿ç”¨æœåŠ¡ç«¯ç»„ä»¶ï¼ˆé»˜è®¤ï¼‰**ï¼š
- è·å–æ•°æ®ï¼ˆæ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ã€APIï¼‰
- è®¿é—®åç«¯èµ„æº
- å‡å°‘å®¢æˆ·ç«¯ JavaScript ä½“ç§¯
- æå‡ SEO

**ä½•æ—¶ä½¿ç”¨å®¢æˆ·ç«¯ç»„ä»¶ï¼ˆ`"use client"`ï¼‰**ï¼š
- éœ€è¦äº¤äº’ï¼ˆonClickã€onChange ç­‰ï¼‰
- ä½¿ç”¨æµè§ˆå™¨ APIï¼ˆwindowã€localStorage ç­‰ï¼‰
- ä½¿ç”¨ React Hooksï¼ˆuseStateã€useEffect ç­‰ï¼‰
- ä½¿ç”¨ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯åº“

#### 2. è·¯ç”±å‚æ•°è·å–

```tsx
// åŠ¨æ€è·¯ç”±å‚æ•°
export default function Page({ params }: { params: { slug: string } }) {
  return <div>{params.slug}</div>;
}

// æŸ¥è¯¢å‚æ•°ï¼ˆå®¢æˆ·ç«¯ç»„ä»¶ï¼‰
"use client";
import { useSearchParams } from 'next/navigation';

export default function Page() {
  const searchParams = useSearchParams();
  const page = searchParams.get('page');
  return <div>Page: {page}</div>;
}
```

#### 3. æ•°æ®è·å–æœ€ä½³å®è·µ

```tsx
// âœ… æ¨èï¼šæœåŠ¡ç«¯ç»„ä»¶ç›´æ¥è·å–
export default async function Page() {
  const data = await fetchData();
  return <div>{data}</div>;
}

// âŒ é¿å…ï¼šåœ¨å®¢æˆ·ç«¯ç»„ä»¶ä¸­è·å–æœåŠ¡ç«¯æ•°æ®
"use client";
export default function Page() {
  const [data, setData] = useState(null);
  useEffect(() => {
    fetch('/api/data').then(res => res.json()).then(setData);
  }, []);
  // ...
}
```

---

## æ€»ç»“

### Next.js çš„æ ¸å¿ƒä¼˜åŠ¿

1. **å¼€ç®±å³ç”¨**ï¼šè·¯ç”±ã€å›¾ç‰‡ä¼˜åŒ–ã€SEO ç­‰åŠŸèƒ½å†…ç½®
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šæœåŠ¡ç«¯æ¸²æŸ“ã€é™æ€ç”Ÿæˆã€ä»£ç åˆ†å‰²è‡ªåŠ¨å¤„ç†
3. **å¼€å‘ä½“éªŒ**ï¼šæ–‡ä»¶ç³»ç»Ÿè·¯ç”±ã€çƒ­é‡è½½ã€TypeScript æ”¯æŒ
4. **ç”Ÿäº§å°±ç»ª**ï¼šå†…ç½®ä¼˜åŒ–ã€é”™è¯¯å¤„ç†ã€ç›‘æ§æ”¯æŒ

### ä¸ React çš„å…³ç³»

- Next.js **åŸºäº React**ï¼Œæ‰€æœ‰ React ç‰¹æ€§éƒ½å¯ä»¥ä½¿ç”¨
- Next.js **æ‰©å±•äº† React**ï¼Œæ·»åŠ äº†è·¯ç”±ã€æ•°æ®è·å–ã€ä¼˜åŒ–ç­‰åŠŸèƒ½
- Next.js **ç®€åŒ–äº† React å¼€å‘**ï¼Œå‡å°‘äº†æ ·æ¿ä»£ç å’Œé…ç½®

### å­¦ä¹ å»ºè®®

1. **å…ˆæŒæ¡ React åŸºç¡€**ï¼šç»„ä»¶ã€Hooksã€çŠ¶æ€ç®¡ç†
2. **ç†è§£ Next.js æ ¸å¿ƒæ¦‚å¿µ**ï¼šæœåŠ¡ç«¯ç»„ä»¶ã€æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ã€æ•°æ®è·å–
3. **å®è·µé¡¹ç›®**ï¼šä»ç®€å•é¡µé¢å¼€å§‹ï¼Œé€æ­¥æ·»åŠ åŠŸèƒ½
4. **é˜…è¯»æ–‡æ¡£**ï¼šNext.js å®˜æ–¹æ–‡æ¡£éå¸¸è¯¦ç»†

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0.0  
**æœ€åæ›´æ–°**ï¼š2024å¹´12æœˆ  
**ç»´æŠ¤è€…**ï¼šäº‘ç²¥

